monitors:
  - name: "namespace-cost-monitoring-overall"
    type: "metric alert"
    query: "avg(last_1d):sum:kubernetes.cost.by_namespace{kubernetes.io/cluster/xquare-v3-cluster:owned} by {namespace} > 100"
    message: |
      네임스페이스 {{namespace.name}}의 일일 비용이 100 달러를 초과했습니다.
      
      @slack-XQUARE-alerts-cost
    tags:
      - "service:cost-monitoring"
      - "env:production"
    options:
      thresholds:
        critical: 100
        warning: 80
      notify_no_data: false
      require_full_window: false
      include_tags: true
      evaluation_delay: 900
  - name: node-cpu-high
    namespace: monitoring
    type: metric alert
    query: >
      avg(last_5m):avg:aws.ec2.cpuutilization{*} by {kube_node} >= 80
    message: >
      🚨 *High Node CPU Alert*
      The average CPU utilization on one or more nodes is over 80% in the last 5 minutes.
      @slack-your-alert-channel
    tags:
      - "env:production"
    priority: 3
    options:
      evaluationDelay: 0
      includeTags: true
      locked: false
      notifyNoData: false
      noDataTimeframe: 10
      thresholds:
        critical: "80"
        warning: "70"